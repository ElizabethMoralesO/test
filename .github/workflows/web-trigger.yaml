name: Simple Web Trigger

on:
    # This workflow can be triggered manually with parameters
    workflow_dispatch:
        inputs:
            message:
                description: "Custom message for the workflow"
                required: false
                default: "Hello from GitHub Pages!"
                type: string
            environment:
                description: "Target environment"
                required: false
                default: "development"
                type: choice
                options:
                    - development
                    - staging
                    - production

permissions:
    actions: write
    contents: read

jobs:
    trigger-dummy-workflow:
        runs-on: ubuntu-latest

        steps:
            - name: Display trigger information
              run: |
                  echo "ğŸ¯ Web Trigger Activated!"
                  echo "ğŸ“ Message: ${{ github.event.inputs.message }}"
                  echo "ğŸŒ Environment: ${{ github.event.inputs.environment }}"
                  echo "ğŸ‘¤ Triggered by: ${{ github.actor }}"
                  echo "ğŸ“… Timestamp: $(date)"

            - name: Trigger dummy workflow
              run: |
                  echo "ğŸš€ Triggering dummy workflow..."

                  # Use the repository's GITHUB_TOKEN to trigger the workflow
                  curl -X POST \
                    -H "Authorization: token ${{ secrets.WORKFLOW_PAT }}" \
                    -H "Accept: application/vnd.github.v3+json" \
                    -H "Content-Type: application/json" \
                    "https://api.github.com/repos/${{ github.repository }}/actions/workflows/dummy-workflow.yaml/dispatches" \
                    -d "{
                      \"ref\": \"main\",
                      \"inputs\": {
                        \"message\": \"${{ github.event.inputs.message }}\",
                        \"environment\": \"${{ github.event.inputs.environment }}\"
                      }
                    }"

                  if [ $? -eq 0 ]; then
                    echo "âœ… Successfully triggered dummy workflow"
                  else
                    echo "âŒ Failed to trigger dummy workflow"
                    exit 1
                  fi
