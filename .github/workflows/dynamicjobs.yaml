name: Dynamic Jobs

on:
  workflow_dispatch:
    inputs:
      environments:
        description: 'List of environments (comma-separated)'
        required: true

jobs:
  dynamic-jobs:
    runs-on: ubuntu-latest
    steps:
      - name: Process environments input
        run: |
          ENVS=(${GITHUB_EVENT_INPUTS_environments//,/ })
          echo "ENVS=${ENVS[*]}" >> $GITHUB_ENV

      - name: Create jobs for each environment
        uses: github.actions/job-creator@v1
        with:
          jobs: ${{ env.ENVS }}
          job-template: |
            name: ${{ job }}
            runs-on: ubuntu-latest
            steps:
              - name: Deploy to ${{ job }}
                run: |
                  # Deployment logic for ${{ job }} goes here
                  echo "Deploying to ${{ job }}"